

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DataHandler &mdash; QF Lib  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DailyDataHandler" href="qf_lib.backtesting.data_handler.daily_data_handler.DailyDataHandler.html" />
    <link rel="prev" title="VolStrategyContractTickerMapper" href="qf_lib.backtesting.contract.contract_to_ticker_conversion.vol_strategy_mapper.VolStrategyContractTickerMapper.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> QF Lib
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">analysis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../backtesting.html">backtesting</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#alpha-model">alpha_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#contract">contract</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../backtesting.html#data-handler">data_handler</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">DataHandler</a></li>
<li class="toctree-l3"><a class="reference internal" href="qf_lib.backtesting.data_handler.daily_data_handler.DailyDataHandler.html">DailyDataHandler</a></li>
<li class="toctree-l3"><a class="reference internal" href="qf_lib.backtesting.data_handler.intraday_data_handler.IntradayDataHandler.html">IntradayDataHandler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#events">events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#execution-handler">execution_handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#fast-alpha-model-tester">fast_alpha_model_tester</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#monitoring">monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#order">order</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#orders-filter">orders_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#portfolio">portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#position-sizer">position_sizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#signals">signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#strategies">strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting.html#trading-session">trading_session</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../common.html">common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../containers.html">containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_providers.html">data_providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../document_utils.html">document_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indicators.html">indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolio_construction.html">portfolio_construction</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QF Lib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../backtesting.html">backtesting</a> &raquo;</li>
        
      <li>DataHandler</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="datahandler">
<h1>DataHandler<a class="headerlink" href="#datahandler" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler">
<em class="property">class </em><code class="sig-prename descclassname">qf_lib.backtesting.data_handler.data_handler.</code><code class="sig-name descname">DataHandler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_provider</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.data_providers.data_provider.DataProvider.html#qf_lib.data_providers.data_provider.DataProvider" title="qf_lib.data_providers.data_provider.DataProvider">qf_lib.data_providers.data_provider.DataProvider</a></span></em>, <em class="sig-param"><span class="n">timer</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.common.utils.dateutils.timer.Timer.html#qf_lib.common.utils.dateutils.timer.Timer" title="qf_lib.common.utils.dateutils.timer.Timer">qf_lib.common.utils.dateutils.timer.Timer</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="qf_lib.data_providers.data_provider.DataProvider.html#qf_lib.data_providers.data_provider.DataProvider" title="qf_lib.data_providers.data_provider.DataProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">qf_lib.data_providers.data_provider.DataProvider</span></code></a></p>
<p>DataHandler is a wrapper which can be used with any AbstractPriceDataProvider in both live and backtest
environment. It makes sure that data “from the future” is not passed into components in the backtest environment.</p>
<p>DataHandler should be used by all the Backtester’s components (even in the live trading setup).</p>
<p>The goal of a DataHandler is to provide backtester’s components with financial data. It makes sure that
no data from the future (relative to a “current” time of a backtester) is being accessed, that is: that there
is no look-ahead bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_provider</strong> (<a class="reference internal" href="qf_lib.data_providers.data_provider.DataProvider.html#qf_lib.data_providers.data_provider.DataProvider" title="qf_lib.data_providers.data_provider.DataProvider"><em>DataProvider</em></a>) – the underlying data provider</p></li>
<li><p><strong>timer</strong> (<a class="reference internal" href="qf_lib.common.utils.dateutils.timer.Timer.html#qf_lib.common.utils.dateutils.timer.Timer" title="qf_lib.common.utils.dateutils.timer.Timer"><em>Timer</em></a>) – timer used to keep track of the data “from the future”</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_futures_chain_tickers" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_futures_chain_tickers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_futures_chain_tickers</span></code></a>(tickers, …)</p></td>
<td><p>Returns tickers of futures contracts, which belong to the same futures contract chain as the provided ticker (tickers), along with their expiration dates in form of a QFSeries.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_history" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_history</span></code></a>(tickers, …)</p></td>
<td><p>Runs DataProvider.get_history(…) but before makes sure that the query doesn’t concern data from the future.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_last_available_price" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_last_available_price"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_last_available_price</span></code></a>(tickers, …)</p></td>
<td><p>Gets the latest available price for given assets as of end_time.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_price" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_price"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_price</span></code></a>(tickers, …)</p></td>
<td><p>Runs DataProvider.get_price(…) but before makes sure that the query doesn’t concern data from the future.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.historical_price" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.historical_price"><code class="xref py py-obj docutils literal notranslate"><span class="pre">historical_price</span></code></a>(tickers, …)</p></td>
<td><p>Returns the latest available data samples, which simply correspond to the last available &lt;nr_of_bars&gt; number of bars.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.supported_ticker_types" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.supported_ticker_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supported_ticker_types</span></code></a>()</p></td>
<td><p>Returns classes of tickers which are supported by this DataProvider.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.use_data_bundle" title="qf_lib.backtesting.data_handler.data_handler.DataHandler.use_data_bundle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">use_data_bundle</span></code></a>(tickers, …)</p></td>
<td><p>Optimises running of the backtest.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_futures_chain_tickers">
<code class="sig-name descname">get_futures_chain_tickers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker">qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker">qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">expiration_date_fields</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.expiration_date_field.ExpirationDateField.html#qf_lib.common.enums.expiration_date_field.ExpirationDateField" title="qf_lib.common.enums.expiration_date_field.ExpirationDateField">qf_lib.common.enums.expiration_date_field.ExpirationDateField</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.expiration_date_field.ExpirationDateField.html#qf_lib.common.enums.expiration_date_field.ExpirationDateField" title="qf_lib.common.enums.expiration_date_field.ExpirationDateField">qf_lib.common.enums.expiration_date_field.ExpirationDateField</a><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span><a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker">qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker</a><span class="p">, </span>Union<span class="p">[</span><a class="reference internal" href="qf_lib.containers.series.qf_series.QFSeries.html#qf_lib.containers.series.qf_series.QFSeries" title="qf_lib.containers.series.qf_series.QFSeries">qf_lib.containers.series.qf_series.QFSeries</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame.html#qf_lib.containers.dataframe.qf_dataframe.QFDataFrame" title="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame">qf_lib.containers.dataframe.qf_dataframe.QFDataFrame</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.get_futures_chain_tickers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_futures_chain_tickers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tickers of futures contracts, which belong to the same futures contract chain as the provided ticker
(tickers), along with their expiration dates in form of a QFSeries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker"><em>FutureTicker</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker"><em>FutureTicker</em></a><em>]</em>) – tickers for which should the future chain tickers be retrieved</p></li>
<li><p><strong>expiration_date_fields</strong> (<a class="reference internal" href="qf_lib.common.enums.expiration_date_field.ExpirationDateField.html#qf_lib.common.enums.expiration_date_field.ExpirationDateField" title="qf_lib.common.enums.expiration_date_field.ExpirationDateField"><em>ExpirationDateField</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.enums.expiration_date_field.ExpirationDateField.html#qf_lib.common.enums.expiration_date_field.ExpirationDateField" title="qf_lib.common.enums.expiration_date_field.ExpirationDateField"><em>ExpirationDateField</em></a><em>]</em>) – field that should be downloaded as the expiration date field, by default last tradeable date</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dictionary, which maps Tickers to QFSeries, consisting of the expiration dates of Future
Contracts: Dict[FutureTicker, QFSeries]. The QFSeries contain the specific Tickers, which belong to the
corresponding futures family, same as the FutureTicker, and are indexed by the expiration dates of
the specific future contracts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker.html#qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker" title="qf_lib.containers.futures.future_tickers.future_ticker.FutureTicker">FutureTicker</a>, Union[<a class="reference internal" href="qf_lib.containers.series.qf_series.QFSeries.html#qf_lib.containers.series.qf_series.QFSeries" title="qf_lib.containers.series.qf_series.QFSeries">QFSeries</a>, <a class="reference internal" href="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame.html#qf_lib.containers.dataframe.qf_dataframe.QFDataFrame" title="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame">QFDataFrame</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_history">
<code class="sig-name descname">get_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">fields</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>Sequence<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">start_date</span><span class="p">:</span> <span class="n">datetime.datetime</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">datetime.datetime</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency">qf_lib.common.enums.frequency.Frequency</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference internal" href="qf_lib.containers.series.qf_series.QFSeries.html#qf_lib.containers.series.qf_series.QFSeries" title="qf_lib.containers.series.qf_series.QFSeries">qf_lib.containers.series.qf_series.QFSeries</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame.html#qf_lib.containers.dataframe.qf_dataframe.QFDataFrame" title="qf_lib.containers.dataframe.qf_dataframe.QFDataFrame">qf_lib.containers.dataframe.qf_dataframe.QFDataFrame</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.qf_data_array.QFDataArray.html#qf_lib.containers.qf_data_array.QFDataArray" title="qf_lib.containers.qf_data_array.QFDataArray">qf_lib.containers.qf_data_array.QFDataArray</a><span class="p">]</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.get_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs DataProvider.get_history(…) but before makes sure that the query doesn’t concern data from the future.</p>
<p>It accesses the latest fully available bar as of “today”, that is: if a bar wasn’t closed for today yet,
then all the PriceFields (e.g. OPEN) will concern data from yesterday. This behaviour is different than the
behaviour of get_price function of DataHandler.
The reason for that is, that it is impossible to infer which of the fields are available before the market
closes (in case of get_price, it is well known that PriceField.Open is available after market opens, but the
DataHandler does not have a valid mapping between PriceField.Open and the string pointing to the open price
field).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataProvider.get_history()</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_last_available_price">
<code class="sig-name descname">get_last_available_price</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency">qf_lib.common.enums.frequency.Frequency</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_time</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.datetime<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>float<span class="p">, </span><a class="reference internal" href="qf_lib.containers.series.qf_series.QFSeries.html#qf_lib.containers.series.qf_series.QFSeries" title="qf_lib.containers.series.qf_series.QFSeries">qf_lib.containers.series.qf_series.QFSeries</a><span class="p">]</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.get_last_available_price"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_last_available_price" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the latest available price for given assets as of end_time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>]</em>) – tickers of the securities which prices should be downloaded</p></li>
<li><p><strong>frequency</strong> (<a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency"><em>Frequency</em></a>) – frequency of the data</p></li>
<li><p><strong>end_time</strong> (<em>datetime</em>) – date which should be used as a base to compute the last available price. The parameter is optional and if
not provided, the end_date will point to the current user time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>last_prices series where:
- last_prices.name contains a date of current prices,
- last_prices.index contains tickers
- last_prices.data contains latest available prices for given tickers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.get_price">
<code class="sig-name descname">get_price</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">fields</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField">qf_lib.common.enums.price_field.PriceField</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField">qf_lib.common.enums.price_field.PriceField</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">start_date</span><span class="p">:</span> <span class="n">datetime.datetime</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">datetime.datetime</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency">qf_lib.common.enums.frequency.Frequency</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference internal" href="qf_lib.containers.series.prices_series.PricesSeries.html#qf_lib.containers.series.prices_series.PricesSeries" title="qf_lib.containers.series.prices_series.PricesSeries">qf_lib.containers.series.prices_series.PricesSeries</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame.html#qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame" title="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame">qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.qf_data_array.QFDataArray.html#qf_lib.containers.qf_data_array.QFDataArray" title="qf_lib.containers.qf_data_array.QFDataArray">qf_lib.containers.qf_data_array.QFDataArray</a><span class="p">]</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.get_price"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.get_price" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs DataProvider.get_price(…) but before makes sure that the query doesn’t concern data from
the future.</p>
<p>In contrast to the DataHandler.get_history(…), it will return a valid Open price in the time between the
Market Open and Market Close.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>]</em>) – tickers for securities which should be retrieved</p></li>
<li><p><strong>fields</strong> (<a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>]</em>) – fields of securities which should be retrieved</p></li>
<li><p><strong>start_date</strong> (<em>datetime</em>) – date representing the beginning of historical period from which data should be retrieved</p></li>
<li><p><strong>end_date</strong> (<em>datetime</em>) – date representing the end of historical period from which data should be retrieved;
if no end_date was provided, by default the current date will be used</p></li>
<li><p><strong>frequency</strong> (<a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency"><em>Frequency</em></a>) – frequency of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None, <a class="reference internal" href="qf_lib.containers.series.prices_series.PricesSeries.html#qf_lib.containers.series.prices_series.PricesSeries" title="qf_lib.containers.series.prices_series.PricesSeries">PricesSeries</a>, <a class="reference internal" href="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame.html#qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame" title="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame">PricesDataFrame</a>, <a class="reference internal" href="qf_lib.containers.qf_data_array.QFDataArray.html#qf_lib.containers.qf_data_array.QFDataArray" title="qf_lib.containers.qf_data_array.QFDataArray">QFDataArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.historical_price">
<code class="sig-name descname">historical_price</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker">qf_lib.common.tickers.tickers.Ticker</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">fields</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField">qf_lib.common.enums.price_field.PriceField</a><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField">qf_lib.common.enums.price_field.PriceField</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">nr_of_bars</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.datetime<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n"><a class="reference internal" href="qf_lib.common.enums.frequency.Frequency.html#qf_lib.common.enums.frequency.Frequency" title="qf_lib.common.enums.frequency.Frequency">qf_lib.common.enums.frequency.Frequency</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference internal" href="qf_lib.containers.series.prices_series.PricesSeries.html#qf_lib.containers.series.prices_series.PricesSeries" title="qf_lib.containers.series.prices_series.PricesSeries">qf_lib.containers.series.prices_series.PricesSeries</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame.html#qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame" title="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame">qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame</a><span class="p">, </span><a class="reference internal" href="qf_lib.containers.qf_data_array.QFDataArray.html#qf_lib.containers.qf_data_array.QFDataArray" title="qf_lib.containers.qf_data_array.QFDataArray">qf_lib.containers.qf_data_array.QFDataArray</a><span class="p">]</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.historical_price"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.historical_price" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latest available data samples, which simply correspond to the last available &lt;nr_of_bars&gt; number
of bars.</p>
<p>In case of intraday data and N minutes frequency, the most recent data may not represent exactly N minutes
(if the whole bar was not available at this time). The time ranges are always aligned to the market open time.
Non-zero seconds and microseconds are in the above case omitted (the output at 11:05:10 will be exactly
the same as at 11:05).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>]</em>) – ticker or sequence of tickers of the securities</p></li>
<li><p><strong>fields</strong> (<a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>]</em>) – PriceField or sequence of PriceFields of the securities</p></li>
<li><p><strong>nr_of_bars</strong> (<em>int</em>) – number of data samples (bars) to be returned.
Note: while requesting more than one ticker, some tickers may have fewer than n_of_bars data points</p></li>
<li><p><strong>end_date</strong> (<em>Optional</em><em>[</em><em>datetime</em><em>]</em>) – last date which should be considered in the query, the nr_of_bars that should be returned will always point
to the time before end_date. The parameter is optional and if not provided, the end_date will point to the
current user time.</p></li>
<li><p><strong>frequency</strong> – frequency of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="qf_lib.containers.series.prices_series.PricesSeries.html#qf_lib.containers.series.prices_series.PricesSeries" title="qf_lib.containers.series.prices_series.PricesSeries">PricesSeries</a>, <a class="reference internal" href="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame.html#qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame" title="qf_lib.containers.dataframe.prices_dataframe.PricesDataFrame">PricesDataFrame</a>, <a class="reference internal" href="qf_lib.containers.qf_data_array.QFDataArray.html#qf_lib.containers.qf_data_array.QFDataArray" title="qf_lib.containers.qf_data_array.QFDataArray">QFDataArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.supported_ticker_types">
<code class="sig-name descname">supported_ticker_types</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.supported_ticker_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.supported_ticker_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns classes of tickers which are supported by this DataProvider.</p>
</dd></dl>

<dl class="py method">
<dt id="qf_lib.backtesting.data_handler.data_handler.DataHandler.use_data_bundle">
<code class="sig-name descname">use_data_bundle</code><span class="sig-paren">(</span><em class="sig-param">tickers: Union[qf_lib.common.tickers.tickers.Ticker, Sequence[qf_lib.common.tickers.tickers.Ticker]], fields: Union[qf_lib.common.enums.price_field.PriceField, Sequence[qf_lib.common.enums.price_field.PriceField]], start_date: datetime.datetime, end_date: datetime.datetime, frequency: qf_lib.common.enums.frequency.Frequency = &lt;Frequency.DAILY: 252&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/qf_lib/backtesting/data_handler/data_handler.html#DataHandler.use_data_bundle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#qf_lib.backtesting.data_handler.data_handler.DataHandler.use_data_bundle" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimises running of the backtest. All the data will be downloaded before the backtest.
Note that requesting during the backtest any other ticker or price field than the ones in the params
of this function will result in an Exception.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.tickers.tickers.Ticker.html#qf_lib.common.tickers.tickers.Ticker" title="qf_lib.common.tickers.tickers.Ticker"><em>Ticker</em></a><em>]</em>) – ticker or sequence of tickers of the securities</p></li>
<li><p><strong>fields</strong> (<a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference internal" href="qf_lib.common.enums.price_field.PriceField.html#qf_lib.common.enums.price_field.PriceField" title="qf_lib.common.enums.price_field.PriceField"><em>PriceField</em></a><em>]</em>) – PriceField or sequence of PriceFields of the securities</p></li>
<li><p><strong>start_date</strong> (<em>datetime</em>) – initial date that should be downloaded</p></li>
<li><p><strong>end_date</strong> (<em>datetime</em>) – last date that should be downloaded</p></li>
<li><p><strong>frequency</strong> – frequency of the data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="qf_lib.backtesting.data_handler.daily_data_handler.DailyDataHandler.html" class="btn btn-neutral float-right" title="DailyDataHandler" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="qf_lib.backtesting.contract.contract_to_ticker_conversion.vol_strategy_mapper.VolStrategyContractTickerMapper.html" class="btn btn-neutral float-left" title="VolStrategyContractTickerMapper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>